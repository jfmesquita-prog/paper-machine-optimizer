function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = JSON.parse(e.parameter.data);
  
  Logger.log('Dados recebidos: ' + JSON.stringify(data));

  if (data.type === 'shiftEntry') {
    // ... (resto do código para inserção de dados do turno)
  } else if (data.type === 'gasConsumption') {
    // ... (resto do código para inserção de dados de consumo de gás)
  }

  return ContentService.createTextOutput('Sucesso!');
}

function doGet() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = sheet.getDataRange().getValues();
  var headers = data.shift();
  
  var jsonData = data.map(function(row) {
    var rowData = {};
    for (var i = 0; i < headers.length; i++) {
      rowData[headers[i]] = row[i];
    }
    return rowData;
  });
  
  return ContentService.createTextOutput(JSON.stringify(jsonData))
    .setMimeType(ContentService.MimeType.JSON);
}
